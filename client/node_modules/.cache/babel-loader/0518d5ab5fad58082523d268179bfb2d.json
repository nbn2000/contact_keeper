{"ast":null,"code":"var exec = require('child_process').exec;\n\nvar tree = require('./tree');\n\nvar utils = require('./utils');\n\nvar hasPS = true; // discover if the OS has `ps`, and therefore can use psTree\n\nexec('ps', function (error) {\n  module.exports.hasPS = hasPS = !error;\n});\n\nmodule.exports = function main(pid, callback) {\n  if (typeof pid === 'number') {\n    pid = pid.toString();\n  }\n\n  if (hasPS && !process.env.NO_PS) {\n    return tree(pid, callback);\n  }\n\n  utils.getStat().then(utils.tree).then(function (tree) {\n    return utils.pidsForTree(tree, pid);\n  }).then(function (res) {\n    return callback(null, res.map(function (p) {\n      return p.PID;\n    }));\n  }).catch(function (error) {\n    return callback(error);\n  });\n};\n\nif (!module.parent) {\n  module.exports(process.argv[2], function (e, pids) {\n    return console.log(pids);\n  });\n}\n\nmodule.exports.hasPS = hasPS;","map":null,"metadata":{},"sourceType":"script"}